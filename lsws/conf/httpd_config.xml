<?xml version="1.0" encoding="UTF-8"?>
<httpServerConfig>
  <serverName>$HOSTNAME</serverName>
  <user>nobody</user>
  <group>nogroup</group>
  <priority>0</priority>
  <enableLVE>0</enableLVE>
  <inMemBufSize>60M</inMemBufSize>
  <swappingDir>/tmp/lshttpd/swap</swappingDir>
  <autoFix503>1</autoFix503>
  <gracefulRestartTimeout>300</gracefulRestartTimeout>
  <mime>conf/mime.properties</mime>
  <showVersionNumber>0</showVersionNumber>
  <adminEmails>root@localhost</adminEmails>
  <logging>
    <log>
      <fileName>logs/error.log</fileName>
      <logLevel>DEBUG</logLevel>
      <debugLevel>0</debugLevel>
      <rollingSize>10M</rollingSize>
      <enableStderrLog>1</enableStderrLog>
    </log>
    <accessLog>
      <fileName>logs/access.log</fileName>
      <logFormat>%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;</logFormat>
      <rollingSize>10M</rollingSize>
      <keepDays>30</keepDays>
      <compressArchive>1</compressArchive>
    </accessLog>
  </logging>
  <indexFiles>index.html, index.php</indexFiles>
  <expires>
    <enableExpires>1</enableExpires>
    <expiresByType>image/*=A604800,text/css=A604800,application/x-javascript=A604800,application/javascript=A604800,font/*=A604800,application/x-font-ttf=A604800</expiresByType>
  </expires>
  <autoLoadHtaccess>1</autoLoadHtaccess>
  <tuning>
    <maxConnections>10000</maxConnections>
    <maxSSLConnections>10000</maxSSLConnections>
    <connTimeout>300</connTimeout>
    <maxKeepAliveReq>10000</maxKeepAliveReq>
    <keepAliveTimeout>5</keepAliveTimeout>
    <sndBufSize>0</sndBufSize>
    <rcvBufSize>0</rcvBufSize>
    <maxReqURLLen>32768</maxReqURLLen>
    <maxReqHeaderSize>65536</maxReqHeaderSize>
    <maxReqBodySize>2047M</maxReqBodySize>
    <maxDynRespHeaderSize>32768</maxDynRespHeaderSize>
    <maxDynRespSize>2047M</maxDynRespSize>
    <maxCachedFileSize>4096</maxCachedFileSize>
    <totalInMemCacheSize>20M</totalInMemCacheSize>
    <maxMMapFileSize>256K</maxMMapFileSize>
    <totalMMapCacheSize>40M</totalMMapCacheSize>
    <useSendfile>1</useSendfile>
    <fileETag>28</fileETag>
    <enableGzipCompress>1</enableGzipCompress>
    <compressibleTypes>default</compressibleTypes>
    <enableDynGzipCompress>1</enableDynGzipCompress>
    <gzipCompressLevel>6</gzipCompressLevel>
    <gzipAutoUpdateStatic>1</gzipAutoUpdateStatic>
    <gzipStaticCompressLevel>6</gzipStaticCompressLevel>
    <brStaticCompressLevel>6</brStaticCompressLevel>
    <gzipMaxFileSize>10M</gzipMaxFileSize>
    <gzipMinFileSize>300</gzipMinFileSize>
    <quicEnable>1</quicEnable>
    <quicShmDir>/dev/shm</quicShmDir>
  </tuning>
  <security>
    <fileAccessControl>
      <followSymbolLink>1</followSymbolLink>
      <checkSymbolLink>0</checkSymbolLink>
      <requiredPermissionMask>000</requiredPermissionMask>
      <restrictedPermissionMask>000</restrictedPermissionMask>
    </fileAccessControl>
    <perClientConnLimit>
      <staticReqPerSec>0</staticReqPerSec>
      <dynReqPerSec>0</dynReqPerSec>
      <outBandwidth>0</outBandwidth>
      <inBandwidth>0</inBandwidth>
      <softLimit>10000</softLimit>
      <hardLimit>10000</hardLimit>
      <gracePeriod>15</gracePeriod>
      <banPeriod>300</banPeriod>
    </perClientConnLimit>
    <CGIRLimit>
      <maxCGIInstances>20</maxCGIInstances>
      <minUID>11</minUID>
      <minGID>10</minGID>
      <priority>0</priority>
      <CPUSoftLimit>10</CPUSoftLimit>
      <CPUHardLimit>50</CPUHardLimit>
      <memSoftLimit>1460M</memSoftLimit>
      <memHardLimit>1470M</memHardLimit>
      <procSoftLimit>400</procSoftLimit>
      <procHardLimit>450</procHardLimit>
    </CGIRLimit>
    <accessDenyDir>
      <dir>/</dir>
      <dir>/etc/*</dir>
      <dir>/dev/*</dir>
      <dir>conf/*</dir>
      <dir>admin/conf/*</dir>
    </accessDenyDir>
    <accessControl>
      <allow>ALL, 127.0.0.1T, 103.21.244.0/22T, 103.22.200.0/22T, 103.31.4.0/22T, 104.16.0.0/13T, 104.24.0.0/14T, 108.162.192.0/18T, 131.0.72.0/22T, 141.101.64.0/18T, 162.158.0.0/15T, 172.64.0.0/13T, 173.245.48.0/20T, 188.114.96.0/20T, 190.93.240.0/20T, 197.234.240.0/22T, 198.41.128.0/17T, 2400:cb00::/32T, 2405:8100::/32T, 2405:b500::/32T, 2606:4700::/32T, 2803:f800::/32T, 2a06:98c0::/29T, 2c0f:f248::/32T, 192.88.134.0/23T, 185.93.228.0/22, 66.248.200.0/22T, 208.109.0.0/22T, 2a02:fe80::/29T</allow>
    </accessControl>
  </security>
  <extProcessorList>
    <extProcessor>
      <type>lsapi</type>
      <name>lsphp</name>
      <address>uds://tmp/lshttpd/lsphp.sock</address>
      <maxConns>10</maxConns>
      <env>PHP_LSAPI_CHILDREN=10</env>
      <env>LSAPI_AVOID_FORK=200M</env>
      <initTimeout>60</initTimeout>
      <retryTimeout>0</retryTimeout>
      <persistConn>1</persistConn>
      <respBuffer>0</respBuffer>
      <autoStart>1</autoStart>
      <path>lsphp74/bin/lsphp</path>
      <backlog>100</backlog>
      <instances>1</instances>
      <priority>0</priority>
      <memSoftLimit>2047M</memSoftLimit>
      <memHardLimit>2047M</memHardLimit>
      <procSoftLimit>1400</procSoftLimit>
      <procHardLimit>1500</procHardLimit>
    </extProcessor>
  </extProcessorList>
  <scriptHandlerList>
    <scriptHandler>
      <suffix>php</suffix>
      <type>lsapi</type>
      <handler>lsphp</handler>
    </scriptHandler>
  </scriptHandlerList>
  <railsDefaults>
    <maxConns>1</maxConns>
    <env>LSAPI_MAX_IDLE=60</env>
    <initTimeout>60</initTimeout>
    <retryTimeout>0</retryTimeout>
    <pcKeepAliveTimeout>60</pcKeepAliveTimeout>
    <respBuffer>0</respBuffer>
    <backlog>50</backlog>
    <runOnStartUp>3</runOnStartUp>
    <extMaxIdleTime>300</extMaxIdleTime>
    <priority>3</priority>
    <memSoftLimit>2047M</memSoftLimit>
    <memHardLimit>2047M</memHardLimit>
    <procSoftLimit>500</procSoftLimit>
    <procHardLimit>600</procHardLimit>
  </railsDefaults>
  <wsgiDefaults>
    <maxConns>5</maxConns>
    <env>LSAPI_MAX_IDLE=60</env>
    <initTimeout>60</initTimeout>
    <retryTimeout>0</retryTimeout>
    <pcKeepAliveTimeout>60</pcKeepAliveTimeout>
    <respBuffer>0</respBuffer>
    <backlog>50</backlog>
    <runOnStartUp>3</runOnStartUp>
    <extMaxIdleTime>300</extMaxIdleTime>
    <priority>3</priority>
    <memSoftLimit>2047M</memSoftLimit>
    <memHardLimit>2047M</memHardLimit>
    <procSoftLimit>500</procSoftLimit>
    <procHardLimit>600</procHardLimit>
  </wsgiDefaults>
  <nodeDefaults>
    <maxConns>5</maxConns>
    <env>LSAPI_MAX_IDLE=60</env>
    <initTimeout>60</initTimeout>
    <retryTimeout>0</retryTimeout>
    <pcKeepAliveTimeout>60</pcKeepAliveTimeout>
    <respBuffer>0</respBuffer>
    <backlog>50</backlog>
    <runOnStartUp>3</runOnStartUp>
    <extMaxIdleTime>300</extMaxIdleTime>
    <priority>3</priority>
    <memSoftLimit>2047M</memSoftLimit>
    <memHardLimit>2047M</memHardLimit>
    <procSoftLimit>500</procSoftLimit>
    <procHardLimit>600</procHardLimit>
  </nodeDefaults>
  <moduleList>
    <module>
      <name>cache</name>
      <internal>1</internal>
      <param>#          1
checkPrivateCache   1
checkPublicCache    1
maxCacheObjSize     10000000
maxStaleAge         200
qsCache             1
reqCookieCache      1
respCookieCache     1
ignoreReqCacheCtrl  1
ignoreRespCacheCtrl 0

enableCache         0
expireInSeconds     3600
enablePrivateCache  0
privateExpireInSeconds 3600
</param>
      <ls_enabled>1</ls_enabled>
    </module>
  </moduleList>
  <virtualHostList>
    <virtualHost>
      <name>Example</name>
      <vhRoot>Example/</vhRoot>
      <configFile>conf/vhosts/Example/vhconf.xml</configFile>
      <allowSymbolLink>1</allowSymbolLink>
      <enableScript>1</enableScript>
      <restrained>1</restrained>
      <setUIDMode>0</setUIDMode>
    </virtualHost>
  </virtualHostList>
  <listenerList>
    <listener>
      <name>Default</name>
      <address>*:80</address>
      <secure>0</secure>
      <vhostMapList>
        <vhostMap>
          <vhost>Example</vhost>
          <domain>*</domain>
        </vhostMap>
      </vhostMapList>
    </listener>
    <listener>
      <name>Defaultssl</name>
      <address>*:443</address>
      <secure>1</secure>
      <vhostMapList>
        <vhostMap>
          <vhost>Example</vhost>
          <domain>*</domain>
        </vhostMap>
      </vhostMapList>
      <keyFile>/usr/local/lsws/conf/example.key</keyFile>
      <certFile>/usr/local/lsws/conf/example.crt</certFile>
    </listener>
  </listenerList>
  <vhTemplateList>
    <vhTemplate>
      <name>centralConfigLog</name>
      <templateFile>conf/templates/ccl.xml</templateFile>
      <listeners>Default</listeners>
      <note>Custom vhost Template</note>
    </vhTemplate>
    <vhTemplate>
      <name>EasyRailsWithSuEXEC</name>
      <templateFile>conf/templates/rails.xml</templateFile>
      <listeners>Default</listeners>
    </vhTemplate>
    <vhTemplate>
      <name>BlaqpanelDefault</name>
      <templateFile>$SERVER_ROOT/conf/templates/blaqpanel-default.xml</templateFile>
      <listeners>Default, Defaultssl</listeners>
      <note>custom ols vhost template for wp-cloud-deploy</note>
    </vhTemplate>
  </vhTemplateList>
</httpServerConfig>